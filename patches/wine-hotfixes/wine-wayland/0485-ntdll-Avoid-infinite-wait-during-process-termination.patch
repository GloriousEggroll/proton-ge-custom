From c733ecee4885c651a89f3689ebbfa3d1add1a61f Mon Sep 17 00:00:00 2001
From: Ziia Shi <mkrsym1@gmail.com>
Date: Wed, 14 Jan 2026 23:50:21 +0100
Subject: [PATCH 485/486] ntdll: Avoid infinite wait during process
 termination.

Wine-Bug: https://bugs.winehq.org/show_bug.cgi?id=59178
---
 dlls/ntdll/threadpool.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/dlls/ntdll/threadpool.c b/dlls/ntdll/threadpool.c
index 5fb11c35698..7d8d416bf66 100644
--- a/dlls/ntdll/threadpool.c
+++ b/dlls/ntdll/threadpool.c
@@ -2083,7 +2083,7 @@ static void tp_object_wait( struct threadpool_object *object, BOOL group_wait )
     struct threadpool *pool = object->pool;
 
     RtlEnterCriticalSection( &pool->cs );
-    while (!object_is_finished( object, group_wait ))
+    while (!RtlDllShutdownInProgress() && !object_is_finished( object, group_wait ))
     {
         if (group_wait)
             RtlSleepConditionVariableCS( &object->group_finished_event, &pool->cs, NULL );
-- 
2.53.0

